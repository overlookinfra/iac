<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>2020-12-11: IAC Team Status Update | Puppet IAC Team</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="2020-12-11: IAC Team Status Update" />
<meta name="author" content="DavidS" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This week has been wild. Lots of community contributions, lots of releases, DSC updates, removing inappropriate language, Cloud CI progress, PDK 2.0, and more! Check out below for the details." />
<meta property="og:description" content="This week has been wild. Lots of community contributions, lots of releases, DSC updates, removing inappropriate language, Cloud CI progress, PDK 2.0, and more! Check out below for the details." />
<link rel="canonical" href="https://puppetlabs.github.io/iac/team/status/2020/12/11/status-update.html" />
<meta property="og:url" content="https://puppetlabs.github.io/iac/team/status/2020/12/11/status-update.html" />
<meta property="og:site_name" content="Puppet IAC Team" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-12-11T00:00:00+00:00" />
<script type="application/ld+json">
{"description":"This week has been wild. Lots of community contributions, lots of releases, DSC updates, removing inappropriate language, Cloud CI progress, PDK 2.0, and more! Check out below for the details.","headline":"2020-12-11: IAC Team Status Update","dateModified":"2020-12-11T00:00:00+00:00","datePublished":"2020-12-11T00:00:00+00:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://puppetlabs.github.io/iac/team/status/2020/12/11/status-update.html"},"url":"https://puppetlabs.github.io/iac/team/status/2020/12/11/status-update.html","author":{"@type":"Person","name":"DavidS"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/iac/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://puppetlabs.github.io/iac/feed.xml" title="Puppet IAC Team" />
    <!-- Google Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-157301458-1', 'auto');
	ga('send', 'pageview', { 'page': location.pathname + location.search + location.hash});
	ga('set', 'anonymizeIp', true);
    </script>
    <!-- End Google Analytics -->
    </head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/iac/">Puppet IAC Team</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/iac/docs/">Docs</a><a class="page-link" href="/iac/modules/">Modules</a><a class="page-link" href="/iac/tools/">Tools</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">2020-12-11: IAC Team Status Update</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2020-12-11T00:00:00+00:00" itemprop="datePublished">Dec 11, 2020
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">DavidS</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>This week has been wild. Lots of community contributions, lots of releases, DSC updates, removing inappropriate language, Cloud CI progress, PDK 2.0, and more! Check out below for the details.</p>

<h2 id="community-contributions">Community Contributions</h2>

<p>We’d like to thank the following people in the Puppet Community for their contributions over this past week:</p>

<ul>
  <li><a href="https://github.com/puppetlabs/provision/pull/143"><code class="language-plaintext highlighter-rouge">provision#143</code></a>: “(feat) Allow for passing docker runtime options”, thanks to <a href="https://github.com/jarretlavallee">jarretlavallee</a></li>
  <li><a href="https://github.com/puppetlabs/puppetlabs-apache/pull/2104"><code class="language-plaintext highlighter-rouge">puppetlabs-apache#2104</code></a>: “(fix) Convert unnecessary multi line warnings to single lines”, thanks to <a href="https://github.com/rj667">rj667</a></li>
  <li><a href="https://github.com/puppetlabs/puppetlabs-apache/pull/2103"><code class="language-plaintext highlighter-rouge">puppetlabs-apache#2103</code></a>: “(MODULES-10887) Set <code class="language-plaintext highlighter-rouge">use_servername_for_filenames</code> for defaults”, thanks to <a href="https://github.com/towo">towo</a></li>
  <li><a href="https://github.com/puppetlabs/puppetlabs-iis/pull/301"><code class="language-plaintext highlighter-rouge">puppetlabs-iis#301</code></a>: “MODULES-10884 Allow a UNC path as the physical path of a web site”, thanks to <a href="https://github.com/palintir">palintir</a></li>
  <li><a href="https://github.com/puppetlabs/puppetlabs-postgresql/pull/1201"><code class="language-plaintext highlighter-rouge">puppetlabs-postgresql#1201</code></a>: “Change - Use systemd drop-in directory for unit overrides”, thanks to <a href="https://github.com/blackknight36">blackknight36</a> and the following people who helped get it over the line (<a href="https://github.com/maage">maage</a>)</li>
  <li><a href="https://github.com/puppetlabs/puppetlabs-scheduled_task/pull/171"><code class="language-plaintext highlighter-rouge">puppetlabs-scheduled_task#171</code></a>: “(DOCS) update docs to match the code.”, thanks to <a href="https://github.com/binford2k">binford2k</a></li>
  <li><a href="https://github.com/puppetlabs/pdk-vanagon/pull/270"><code class="language-plaintext highlighter-rouge">pdk-vanagon#270</code></a>: “Update Gemfile”, thanks to <a href="https://github.com/sbeaulie">sbeaulie</a> and the following people who helped get it over the line (<a href="https://github.com/scotje">scotje</a>)</li>
  <li><a href="https://github.com/puppetlabs/pdk-vanagon/pull/269"><code class="language-plaintext highlighter-rouge">pdk-vanagon#269</code></a>: “(MAINT) Re-enable bundle pre-install for Puppet 7.x”, thanks to <a href="https://github.com/scotje">scotje</a></li>
  <li><a href="https://github.com/puppetlabs/puppet-modulebuilder/pull/29"><code class="language-plaintext highlighter-rouge">puppet-modulebuilder#29</code></a>: “Ignore all hidden files in the root dir”, thanks to <a href="https://github.com/ekohl">ekohl</a></li>
  <li><a href="https://github.com/puppetlabs/puppet-modulebuilder/pull/27"><code class="language-plaintext highlighter-rouge">puppet-modulebuilder#27</code></a>: “Preserve directory mtimes”, thanks to <a href="https://github.com/ekohl">ekohl</a></li>
</ul>

<p>On Community Monday we processed 17 PRs (5 on tooling 12 on modules), releasing 6 modules, despite early vacations starting to eat into our availability.
Next week we’ll see if we can go beyond PRs into the issues and tickets and start processing some of that backlog.
Please swing by our <a href="https://puppet.com/community/office-hours/">office hours on Monday</a> on Slack if you want to directly contact us about anything module related.</p>

<h2 id="new-module--gem-releases---puppet-7-support">New Module / Gem Releases - Puppet 7 support</h2>

<p>Our supported modules are now officially compatible with Puppet 7.
We’re committed to rolling out the module releases as fast as we can, incorporating as many valuable changes as possible from the Community in to the releases too.
Some modules pushed to the Forge so far, are:</p>

<ul>
  <li><a href="https://github.com/puppetlabs/puppetlabs-apache"><code class="language-plaintext highlighter-rouge">puppetlabs-apache</code></a> (<code class="language-plaintext highlighter-rouge">5.8.0</code>)</li>
  <li><a href="https://github.com/puppetlabs/puppetlabs-apt"><code class="language-plaintext highlighter-rouge">puppetlabs-apt</code></a> (<code class="language-plaintext highlighter-rouge">7.7.0</code>)</li>
  <li><a href="https://github.com/puppetlabs/puppetlabs-chocolatey"><code class="language-plaintext highlighter-rouge">puppetlabs-chocolatey</code></a> (<code class="language-plaintext highlighter-rouge">5.2.0</code>)</li>
  <li><a href="https://github.com/puppetlabs/puppetlabs-inifile"><code class="language-plaintext highlighter-rouge">puppetlabs-inifile</code></a> (<code class="language-plaintext highlighter-rouge">4.4.0</code>)</li>
  <li><a href="https://github.com/puppetlabs/puppetlabs-package"><code class="language-plaintext highlighter-rouge">puppetlabs-package</code></a> (<code class="language-plaintext highlighter-rouge">1.4.0</code>)</li>
  <li><a href="https://github.com/puppetlabs/puppetlabs-powershell"><code class="language-plaintext highlighter-rouge">puppetlabs-powershell</code></a> (<code class="language-plaintext highlighter-rouge">4.1.0</code>)</li>
  <li><a href="https://github.com/puppetlabs/puppetlabs-registry"><code class="language-plaintext highlighter-rouge">puppetlabs-registry</code></a> (<code class="language-plaintext highlighter-rouge">3.2.0</code>)</li>
</ul>

<h2 id="tales-from-the-intern">Tales from the Intern</h2>

<p>Disha’s week 15 was very busy too. Find out more information <a href="https://puppetlabs.github.io/iac/docs/life_of_intern.html">on her blog</a></p>

<h2 id="dsc">DSC</h2>

<p>This was a busy week for DSC!
On Monday, we rebuilt <em>everything</em> on the forge (incrementing the last digit of all released versions by 1) to take advantage of some new improvements to the type generation (more on that below!)</p>
<ul>
  <li>we have also started the process of backporting all prior-released versions of the PowerShell modules with DSC resources already found on the forge.
Finally, we pushed out a quick bugfix to the base provider in <code class="language-plaintext highlighter-rouge">puppetlabs-pwshlib</code>, so be sure to update your pins to <code class="language-plaintext highlighter-rouge">0.6.2</code>!</li>
</ul>

<h3 id="changes-to-puppetized-dsc-resource-types">Changes to Puppetized DSC Resource Types</h3>

<p>If you’d like to walk these changes more deeply, you can checkout our <a href="https://github.com/puppetlabs/Puppet.Dsc/blob/main/CHANGELOG.md#020---2020-12-04">latest changelog entry</a>.
In short:</p>
<ul>
  <li>Cleaned up some generated documentation</li>
  <li>Added handling for non-retrievable DSC Resource properties as parameters (no more flapping on specifying credentials or <code class="language-plaintext highlighter-rouge">Force</code>, etc)</li>
  <li>Added handling for read-only properties so they show up in run reports</li>
  <li>Collapsed the <code class="language-plaintext highlighter-rouge">dsc_ensure</code> and <code class="language-plaintext highlighter-rouge">ensure</code> keywords so you only need to specify <code class="language-plaintext highlighter-rouge">dsc_ensure</code> and then <em>only if</em> the DSC Resource is actually ensurable (fixing flapping and ensuring resources as absent!)</li>
  <li>Fixed bug in type mapping for nested CIM Instances</li>
</ul>

<h2 id="inappropriate-terminology">Inappropriate Terminology</h2>

<p>With everything else going on, we do not want to forget our effort to remove exclusive and inappropriate terminology from our code base. Here’s a snapshot of our current progress:</p>

<ul>
  <li>31 modules updated</li>
  <li>4 in progress</li>
  <li>15 remaining</li>
</ul>

<p>That’s 62% completed.</p>

<h2 id="content-cloud-ci-project">Content Cloud CI Project</h2>

<p>The project really has been turning a corner.
This week we onboarded a number of modules with no issues at all, including the first module of another team.</p>

<p>As part of our <a href="https://www.honeycomb.io/">Honeycomb</a> investment, I’ve published an <a href="https://github.com/honeycombio/buildevents/pull/74">enhancement to their buildevents tooling</a> that will allow us to collect the entire stack of a nightly acceptance test run in one place.
This goes from from the Github Actions job through the rake task, through the process rake starts, through the webservice call, through our provisioning backend, to the call to terraform applying.
It also includes our rspec tests running in that job, through litmus and bolt into the newly provisioned machine.</p>

<p>Here’s a screenshot of how it looks:
<img src="/iac/assets/2020-12-11-status-update/cloud-ci-full-capture.png" alt="screenshot of a honeycomb waterfall trace diagram showing the flow of calls from github into our backend service and beyond" /></p>

<p>Sidenote: Thanks to <a href="https://github.com/hsnodgrass">Heston</a> for more dynamic build-matrix calculations: the development version of litmus now can also calculate which puppet collections are <a href="https://github.com/puppetlabs/puppet_litmus/pull/357">necessary for testing</a> from metadata.</p>

<h3 id="porting-progress">Porting Progress</h3>

<p>As of earlier this morning we have 30 of 47 modules ported over to the new CI.
Through the <a href="https://github.com/puppetlabs/community_management">community scripts</a> we have a public report on the <a href="https://puppetlabs.github.io/community_management/GithubActionsReport.html">nightly CI runs</a>.
While yesterday night was especially rough with some timeouts and other issues across multiple modules, on a cell-by-cell basis 435 of 447 cells succeeded (97.3%) with an all week average of 2265/2361 (95.9%).
For everyone except the few people who have access to the <a href="https://ui.honeycomb.io/puppet-modules/datasets/litmus-tests/result/tVLDJWy1Avr">honeycomb stats</a>, here’s a screenshot of the top-level success/failure chart:</p>

<p><img src="/iac/assets/2020-12-11-status-update/pass-fail-honeycomb.png" alt="Screenshot of a stacked area graph showing job successes and failures over the last 24 hours. There is a block of tests running from midnight through half three with an arbitrary value highlighted showing 21 cells succeeding and 2 failing for this particular 5 minute span." /></p>

<p>Once the aforementioned improvements to the tooling get merged and released, we can drill into the failing cells from this view and get all the details on what went wrong.</p>

<p>Currently open issues:</p>
<ul>
  <li>several timeout issues in communication indicate need for some level of retrying to improve robustness. We’ll have to investigate where that is most appropriate.</li>
  <li>apt: false negative as we don’t need cloud-ci for apt and github is not amused about the empty matrix</li>
  <li>concat: bolt windows exit code issue</li>
  <li>java_ks: transient failure with keytool availability</li>
  <li>kubernetes: will need more work to get a full cluster working in cloud-ci</li>
  <li>reboot, tagmail: provisioning failed on one machine each</li>
  <li>our result tracking is not dealing well yet with re-runs (<a href="https://github.com/kvrhdn/gha-buildevents/issues/16">kvrhdn/gha-buildevents#16</a>)</li>
</ul>

<p>In general we are definitely benefitting (in the loosest sense) from the GCP virtual machines being close to real deployments in their setup and runtime behaviour.
Through this we are now detecting edge cases and robustness issues with our puppet code that we can fix once and for all in the modules or the core puppet code leading to a better experience for all.</p>

<h2 id="preparing-for-pdk-20">Preparing for PDK 2.0</h2>

<p>While it’s gonna be a small-ish release, PDK 2.0 is in the works, dropping the Ruby 2.1 runtime and with it Puppet 4.
We’re gonna take that opportunity and do some early spring cleaning on some components we’ve been dragging along.
The first thing to land for that is a fresh 1.0 release of the <a href="https://github.com/puppetlabs/puppet-module-gems">puppet-module-gems</a> with Ruby 2.1 and Ruby 2.3 dropped, and a <a href="https://github.com/puppetlabs/puppet-module-gems/pull/156">current rubocop</a>.
This also requires an update to the <a href="https://github.com/puppetlabs/pdk-templates">pdk-templates</a> to <a href="https://github.com/puppetlabs/pdk-templates/pull/371">provide the new defaults</a>.
While we try to sequence this work in a way that minimizes impact, please be aware that this might impact you over the next couple of days if you’re tracking the <code class="language-plaintext highlighter-rouge">main</code> branch of pdk-templates.</p>

<h2 id="other-changes">“Other” changes</h2>

<ul>
  <li>firewall: Add support for the –condition parameter - https://github.com/puppetlabs/puppetlabs-firewall/pull/941</li>
  <li>
    <p>apache: Fix bool2httpd function call for older ruby versions - https://github.com/puppetlabs/puppetlabs-apache/pull/2102</p>

  </li>
</ul>

  </div><a class="u-url" href="/iac/team/status/2020/12/11/status-update.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/iac/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Puppet IAC Team</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Puppet IAC Team</li><li><a class="u-email" href="mailto:ia_content@puppet.com">ia_content@puppet.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/puppetlabs"><svg class="svg-icon"><use xlink:href="/iac/assets/minima-social-icons.svg#github"></use></svg> <span class="username">puppetlabs</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Team blog and list of maintained tools by and for the Puppet Infrastructure Automation Content Team.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
